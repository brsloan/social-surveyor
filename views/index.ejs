<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Voting App</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">

    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.3.10/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-router/0.2.10/angular-ui-router.js"></script>
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>

    <script src="/javascripts/angularApp.js"></script>
    
  </head>

  <body >

    <nav class="navbar navbar-default pull-right"  ng-controller="NavCtrl">
      <ul class="nav navbar-nav">
        <li ng-show="isLoggedIn()"><a>{{ currentUser() }}</a></li>
        <li ng-show="isLoggedIn()"><a href="/#/home">Add Poll</a></li>
        <li ng-show="isLoggedIn()"><a href="/#/polls">View Polls</a></li>
        <li ng-show="isLoggedIn()"><a href="" ng-click="logOut()">Log Out</a></li>
        <li ng-hide="isLoggedIn()"><a href="/#/login">Log In</a></li>
        <li ng-hide="isLoggedIn()"><a href="/#/register">Register</a></li>
      </ul>
    </nav>

    <div class="row">
      <div class="col-md-6 col-md-offset-3">
        <ui-view></ui-view>
      </div>
    </div>
    
    <script type="text/ng-template" id="/home.html">
      <div class="page-header">
        <h1>Voting App</h1>
      </div>
      
      <form ng-submit="addPoll()"
         ng-show="isLoggedIn()">
        <h2>New Poll</h2>
        
        <div class="form-group">
          <input type="text"
            class="form-control"
            placeholder="Poll Name"
            ng-model="title" required></input>
        </div>
        
        <h3>Options</h3>
        
        <div ng-repeat="option in options" class="form-group">
          <input type="text" ng-model="option.title" placeholder="Poll Option" class="form-control" required></input>
        </div>
        
        <div class="form-group">
          <div class="btn btn-success" ng-click="addOption()"><span class="glyphicon glyphicon-plus"></span> Add Option</div>
          <div class="btn btn-primary btn-danger" ng-click="removeOption()"><span class="glyphicon glyphicon-minus"></span> Remove Option</div>
        </div>
        <div class="form-group">
          <button type="submit" class="btn btn-primary">Create Poll</button>
        </div>
      </form>      
    </script>
    
    <script type="text/ng-template" id="/polls.html">
    
      <div class="page-header">
        <h1>Voting App</h1>
      </div>
    
      <h2>Active Polls</h2>
      <div ng-repeat="poll in polls">
      
      <h3><span ng-click="deletePoll(poll._id)" class="btn btn-danger glyphicon glyphicon-remove"></span><a href="/#/{{currentUser}}/polls/{{poll.title}}"> {{poll.title}}</a></h3>
     
      
      </div>
    
    </script>
    
    <script type="text/ng-template" id="/poll.html">
    
      <div class="page-header">
        <h1>Voting App</h1>
      </div>
    
      <h2>{{poll.title}}?</h2>
      
      <div class="form-group">
      <form ng-submit="voteForOption()" ng-hide="hasVoted">
      <div ng-repeat="option in poll.options" class="form-control">
        <input type="radio" value="{{option._id}}" name="chosenOption" ng-model="chosenOption.id" required> {{option.title}}
      </div>
      <button type="submit" class="btn btn-primary">Cast your meaningless vote.</button>
      </form>
      </div>
      
      <div class="form-group">
      <form ng-hide="!isLoggedIn">
        <h4>Add an option:</h4>
        <input type="text" ng-model="extraOption.title" class="form-control" placeholder="A completely different option..." required></input>
        <div class="btn btn-primary" ng-click="addOption()">Add</div>
      </form>
      </div>
      
    <div id="chart_div" ng-show="hasVoted"></div>
      
    
    </script>
      
    <script type="text/ng-template" id="/register.html">

      <div class="page-header">
        <h1>Flapper News</h1>
      </div>

      <div ng-show="error" class="alert alert-danger row">
        <span>{{ error.message }}</span>
      </div>

      <form ng-submit="register()"
        style="margin-top:30px;">
        <h3>Register</h3>

        <div class="form-group">
          <input type="text"
            class="form-control"
            placeholder="Username"
            ng-model="user.username"></input>
        </div>
        <div class="form-group">
          <input type="password"
          class="form-control"
          placeholder="Password"
          ng-model="user.password"></input>
        </div>
        <button type="submit" class="btn btn-primary">Register</button>
      </form>
    </script>

    <script type="text/ng-template" id="/login.html">
      <div class="page-header">
        <h1>Flapper News</h1>
      </div>

      <div ng-show="error" class="alert alert-danger row">
        <span>{{ error.message }}</span>
      </div>

      <form ng-submit="logIn()"
        style="margin-top:30px;">
        <h3>Log In</h3>

        <div class="form-group">
          <input type="text"
            class="form-control"
            placeholder="Username"
            ng-model="user.username"></input>
        </div>
        <div class="form-group">
          <input type="password"
            class="form-control"
            placeholder="Password"
            ng-model="user.password"></input>
        </div>
        <button type="submit" class="btn btn-primary">Log In</button>
      </form>
    </script>



    
  </body>
</html>
